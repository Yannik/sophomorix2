#!/usr/bin/perl 
# Dieses Script (sophomorix-setup) wurde von Rüdiger Beck erstellt
# Es ist freie Software
# Bei Fehlern wenden Sie sich bitte an mich.
# jeffbeck@web.de  oder  jeffbeck@gmx.de


# This Script adds directories and files that are necessary for sophomorix-base 
# It should be run as postinst
use Sophomorix::SophomorixBase; 

# Einlesen der Konfigurationsdatei für Entwickler
{ package DevelConf ; do "/etc/sophomorix/devel/user/sophomorix-devel.conf"}

print "##### sophomorix-setup is configuring the system for sophomorix-base ...\n";

# repair.directories einlesen
&get_alle_verzeichnis_rechte();


# adding existing user root to samba
###
###  ???
###

# Adding directories
# First Parameter: search for "$homedir_teacher" in repair.directories an do NOT
#    expand to the variable $homedir_teacher (i.e. dont forget the leading \)
# Second Parameter: Expand to the contents of $homedir_teacher wich is defined in
#    sophomorix-devel.conf 
&setup_verzeichnis("\$homedir_teacher","$DevelConf::homedir_teacher");
&setup_verzeichnis("\$homedir_admin","$DevelConf::homedir_admin");
&setup_verzeichnis("\$homedir_pupil","$DevelConf::homedir_pupil");
&setup_verzeichnis("\$homedir_ws","$DevelConf::homedir_ws");

# samba
&setup_verzeichnis("\$homedir_samba","$DevelConf::homedir_samba");
&setup_verzeichnis("\$homedir_samba_netlogon",
                   "$DevelConf::homedir_samba_netlogon");
&setup_verzeichnis("\$homedir_samba_progs",
                   "$DevelConf::homedir_samba_progs");
&setup_verzeichnis("\$homedir_samba_cds",
                   "$DevelConf::homedir_samba_cds");

# share
&setup_verzeichnis("\$share_share","$DevelConf::share_share");
&setup_verzeichnis("\$share_exams","$DevelConf::share_exams");
&setup_verzeichnis("\$share_classes","$DevelConf::share_classes");
&setup_verzeichnis("\$share_subclasses","$DevelConf::share_subclasses");
&setup_verzeichnis("\$share_projects","$DevelConf::share_projects");
&setup_verzeichnis("\$share_school","$DevelConf::share_school");

# tasks
&setup_verzeichnis("\$tasks_tasks","$DevelConf::tasks_tasks");
&setup_verzeichnis("\$tasks_classes","$DevelConf::tasks_classes");
&setup_verzeichnis("\$tasks_subclasses","$DevelConf::tasks_subclasses");
&setup_verzeichnis("\$tasks_projects","$DevelConf::tasks_projects");


#this is old stuff, only for reference:
###system("install -d -oadmin -gadmin -m0700 /home/admin");
###system("install -d -oadmin -gadmin -m0775 /home/klassenarbeit");
###system("install -d -oadmin -gadmin -m0775 /home/lehrer");
###system("install -d -oadmin -glehrer -m2751 /home/schueler");
###system("install -d -oadmin -gadmin -m1775 /home/tausch");
###system("install -d -oadmin -glehrer -m0751 /home/tausch/klassen");
###system("install -d -oadmin -gadmin -m0775 /home/workstations");
###system("install -d -oadmin -gadmin -m0775 /home/aufgaben");
###system("install -d -oadmin -gadmin -m0700 /home/samba/netlogon");

#&check_datei_touch("${DevelConf::users_pfad}/schueler.txt");


# make important data readable by root only
&setup_verzeichnis("\$var_lib_pfad","$DevelConf::var_lib_pfad");


