.\"                                      Hey, EMACS: -*- nroff -*-
.\" First parameter, NAME, should be all caps
.\" Second parameter, SECTION, should be 1-8, maybe w/ subsection
.\" other parameters are allowed: see man(7), man(1)
.TH SOPHOMORIX-QUOTA 8 "November 29, 2004"
.\" Please adjust this date whenever revising the manpage.
.\"
.\" Some roff macros, for reference:
.\" .nh        disable hyphenation
.\" .hy        enable hyphenation
.\" .ad l      left justify
.\" .ad b      justify to both left and right margins
.\" .nf        disable filling
.\" .fi        enable filling
.\" .br        insert line break
.\" .sp <n>    insert n+1 empty lines
.\" for manpage-specific macros, see man(7)
.SH NAME
sophomorix-quota \- Quota setzen (usrquota)
.SH SYNOPSIS
.B sophomorix-quota
.RI [ options ] 
.br
.SH DESCRIPTION
.B sophomorix-quota
.br
sophomorix-quota liest Quotaangaben aus Konfigurationsdateien ein und
berechnet daraus die Quota jedes einzelnen users. Das ermittelte Quota
wird in die sophomorix-Datenbank eingetragen und die Quota werden im
System gesetzt.
.TP
Folgende Dateien dienen zur Konfiguration von Quotaangaben:
.TP
.B 1. Generelles Einschalten bzw. ausschalten von Quota
Datei:  /etc/sophomorix/user/sophomorix.conf
.TP
.B 2. Standard-Quotawerte für Lehrer, Schüler, Workstation
Datei:  /etc/sophomorix/user/quota.txt
.TP
.B 3. Quota einzelner user AUSSER lehrer, z. B. admin
Datei:  /etc/sophomorix/user/quota.txt
.TP
.B 4. Quota einzelner lehrer
Datei:  /etc/sophomorix/user/lehrer.txt
.TP
.B 5. Quotaangaben für Klassen (AdminClass):
Datei  /etc/sophomorix/user/schuleinfo.txt
(Diese Datei wird wahrscheinlich in Kürze umbenannt)
.TP
.B 6. Quotaangaben für Projekte: 
Diese Quotaangaben werden mit dem Befehl
sophomorix-project direkt in die sophomorix-Datenbank eingetragen.
.br
Achtung: Bei diesen Quotaangaben handelt es sich um zusätzliche Quota
(AddQuota), die zu den aus obigen Dateien ermittelten Quota DAZUKOMMEN.
.br
Dieses Feature ist im Moment noch nicht enthalten!!!
.PP
.SH Syntax von Quotaangaben
Quotaangaben haben z.B. bei 3 Filesystemen mit 'usrquota' folgende Syntax:
.br
   30+24+1000
.br
Mehr Informationen beim Aufruf von:
.br
   sophomorix-quota -i
.br
Dazu muss in sophomorix.conf use_quota="yes" gesetzt sein.   
.SH Vorbereitung/Installation
Für ein Debian System mit Debian-Kernel unterscheidet sich die
Installation je nach verwendeter Kernelversion:
.TP
.B Kernel 2.4.x:
.TP
1. Installieren Sie das Paket quota.
Dies ist schon erledigt, wenn sie das paket sophomorix-base
installiert haben.
.TP
2. Editieren Sie /etc/fstab 
Tragen sie in /etc/fstab für diejenigen Filesysteme die mountoption
usrquota ein, die sie quotieren wollen. Prüfen sie durch einen reboot,
ob die Einstellung dauerhaft funktionieren.
.TP
3. Entfernen unpassender Quotadateien
In jedem quotierten Filesystem entsteht beim mounten evtl. die Datei
aquota.user. Diese Datei hat für den Kernel 2.4.x das falsche Format
und muss gelöscht werden.
.TP
3. quotacheck
Erzeugen sie nun die passende Quotadatei quota.user mit dem Befehl:
   quotacheck -ucvm -F vfsold -a
.TP
4. Schalten sie Quota ein
   quotaon -avu
.TP
5. Quota in sophomorix einschalten 
Damit sophomorix beim Anlegen von Usern Quota setzt, setzen sie in sophomorix.conf 
folgende Variable:
   use_quota="yes"
.TP
6. Setzen von Standard-Werten für Quota Setzen Sie in den obigen
Dateien die Standard-Werte für Quota auf passende Werte. Beachten sie,
dass die Quotaangaben mit der Anzahl der quotierten
Filesysteme(Windows-Begriff: Partitionen) übereinstimmt (siehe Syntax
der Quotaangaben).
.TP
7. Rufen Sie folgenden Befehl auf, um Quota für alle user zu setzen:
   sophomorix-quota
.PP
.B Kernel 2.6.x:
.TP
1. Installieren Sie das Paket quota.
Dies ist schon erledigt, wenn sie das paket sophomorix-base
installiert haben.
.TP
2. ??????
.PP
.SH OPTIONS
.B sophomorix-quota
benützt die GNU command line syntax, mit langen Optionen, die mit zwei
Bindestrichen (`-') beginnen:
.TP
.B -h, --help
Kurzübersicht über Optionen
.TP
.B -v, --verbose
Sagt, was das Programm gerade macht (verbose)
.TP
.B -vv, --verbose --verbose
Sagt ungeheuer genau, was das Programm gerade macht (very verbose)
.TP
.B -i , --info
Listet Dateisysteme auf, die aktuell mit der Option usrquota gemountet
sind. Auf diesen Dateisystemen kann sophomorix-quota die Quota
verändern.
.TP
.B -t, --test
sophomorix-quota läuft möglichst normal ab, ohne Quota tatsächlich zu
verändern. Es kann zu unsinnigen Fehlermeldungen kommen, da einige
Schritte beim setzten von Quota auf anderen aufbauen.
.TP
.B -s, --system
sophomorix-quota benutzt anstelle des Perl-Moduls Quota::
den Systembefehl des Betriebssystems Linux, Kernel 2.4.x (2.6.x ????):

.B   setquota -u username 

um Quota zu setzten. Dies wird nicht empfohlen, da es länger dauert
und vom Betriebsystem bzw. Kernel-Version abhängig ist.
.TP
.SH SEE ALSO
.BR sophomorix (8),
.BR sophomorix-teach-in (8),
.BR sophomorix-add (8),
.BR sophomorix-move (8),
.BR sophomorix-kill (8),
.BR sophomorix-print (8),
.BR sophomorix-user (8),
.BR sophomorix-split (8),
.BR sophomorix-project (8),
.BR sophomorix-quota (8),
.\".BR baz (1).
.\".br
.\"You can see the full options of the Programs by calling for example 
.\".IR "sophomrix-quota -h" ,
.
.SH AUTHOR
This manual page was written by <jeffbeck@web.de>.
